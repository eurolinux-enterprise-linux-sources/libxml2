From 183d094a2637ebfbf56c6262390cb62b25f43a28 Mon Sep 17 00:00:00 2001
From: Hugh Davenport <hugh@allthethings.co.nz>
Date: Mon, 30 Nov 2015 18:53:52 +0800
Subject: [PATCH] CVE-2015-8242 Buffer overead with HTML parser in push mode
To: libvir-list@redhat.com

For https://bugzilla.gnome.org/show_bug.cgi?id=756372
Error in the code pointing to the codepoint in the stack for the
current char value instead of the pointer in the input that the SAX
callback expects
Reported and fixed by Hugh Davenport

Signed-off-by: Daniel Veillard <veillard@redhat.com>
---
 HTMLparser.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/HTMLparser.c b/HTMLparser.c
index f9ffe57..eaacf23 100644
--- a/HTMLparser.c
+++ b/HTMLparser.c
@@ -5250,12 +5250,12 @@ htmlParseTryOrFinish(htmlParserCtxtPtr ctxt, int terminate) {
 			    if (IS_BLANK_CH(cur)) {
 				if (ctxt->sax->ignorableWhitespace != NULL)
 				    ctxt->sax->ignorableWhitespace(
-					    ctxt->userData, &cur, 1);
+					    ctxt->userData, &in->cur[0], 1);
 			    } else {
 				htmlCheckParagraph(ctxt);
 				if (ctxt->sax->characters != NULL)
 				    ctxt->sax->characters(
-					    ctxt->userData, &cur, 1);
+					    ctxt->userData, &in->cur[0], 1);
 			    }
 			}
 			ctxt->token = 0;
-- 
2.5.0

